@model LoginViewModel
@{
    ViewData["Title"] = "會員登入";
}

<div class="container py-5">
    <div class="row justify-content-center">
        <div class="col-md-6 col-lg-4">
            <div class="card shadow">
                <div class="card-header bg-primary text-white text-center">
                    <h3 class="mb-0">
                        <i class="fas fa-sign-in-alt"></i> 會員登入
                    </h3>
                </div>
                <div class="card-body p-4">
                    <form asp-action="Login" method="post" novalidate>
                        <input asp-for="ReturnUrl" type="hidden" />
                        <div asp-validation-summary="ModelOnly" class="alert alert-danger d-none"></div>
                        
                        <div class="form-floating mb-3">
                            <input asp-for="UserId" class="form-control" id="userId" placeholder="請輸入使用者ID" autofocus />
                            <label for="userId">
                                <i class="fas fa-user"></i> 使用者ID
                            </label>
                            <span asp-validation-for="UserId" class="field-validation-error"></span>
                        </div>

                        <div class="form-floating mb-3">
                            <input asp-for="Password" class="form-control" id="password" placeholder="請輸入密碼" />
                            <label for="password">
                                <i class="fas fa-lock"></i> 密碼
                            </label>
                            <span asp-validation-for="Password" class="field-validation-error"></span>
                        </div>

                        <div class="form-check mb-3">
                            <input asp-for="RememberMe" class="form-check-input" id="rememberMe" />
                            <label class="form-check-label" for="rememberMe">
                                記住我的登入狀態
                            </label>
                        </div>

                        <div class="d-grid gap-2">
                            <button type="submit" class="btn btn-primary btn-lg">
                                <i class="fas fa-sign-in-alt"></i> 登入
                            </button>
                        </div>
                        
                        <hr class="my-4">
                        
                        <div class="text-center">
                            <p class="text-muted mb-2">還沒有帳號？</p>
                            <a href="@Url.Action("Register", "Account")" class="btn btn-outline-primary">
                                <i class="fas fa-user-plus"></i> 立即註冊
                            </a>
                        </div>
                        
                        <div class="text-center mt-3">
                            <a href="@Url.Action("Index", "Home")" class="text-muted">
                                <i class="fas fa-arrow-left"></i> 返回首頁
                            </a>
                        </div>
                    </form>
                </div>
            </div>
            
            <!-- 示範帳號提示 -->
            <div class="card mt-3 border-info">
                <div class="card-header bg-info text-white">
                    <h6 class="mb-0">
                        <i class="fas fa-info-circle"></i> 示範說明
                    </h6>
                </div>
                <div class="card-body">
                    <p class="text-muted small mb-2">
                        <strong>測試用途：</strong>您可以先註冊一個測試帳號，或使用以下示範資訊：
                    </p>
                    <ul class="small text-muted mb-0">
                        <li>任何已註冊的使用者ID</li>
                        <li>密碼：任意輸入（目前為簡化版本）</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <script>
        $(document).ready(function() {
            // 表單驗證
            $('form').on('submit', function(e) {
                let isValid = true;
                
                // 清除之前的錯誤狀態
                $('.is-invalid').removeClass('is-invalid');
                $('.alert-danger').addClass('d-none');
                
                // 驗證使用者ID
                const userId = $('#userId').val().trim();
                if (!userId) {
                    $('#userId').addClass('is-invalid');
                    showFieldError('UserId', '請輸入使用者ID');
                    isValid = false;
                }
                
                // 驗證密碼
                const password = $('#password').val().trim();
                if (!password) {
                    $('#password').addClass('is-invalid');
                    showFieldError('Password', '請輸入密碼');
                    isValid = false;
                }
                
                if (!isValid) {
                    e.preventDefault();
                    showError('請填寫所有必填欄位');
                    return false;
                }
                
                // 顯示載入狀態
                const $submitBtn = $(this).find('button[type="submit"]');
                const originalText = $submitBtn.html();
                $submitBtn.prop('disabled', true)
                          .html('<span class="spinner-border spinner-border-sm"></span> 登入中...');
            });
            
            // 即時清除錯誤狀態
            $('input').on('input', function() {
                $(this).removeClass('is-invalid');
                const fieldName = $(this).attr('name');
                clearFieldError(fieldName);
            });
        });
        
        function showFieldError(fieldName, message) {
            const field = $(`input[name="${fieldName}"]`);
            field.addClass('is-invalid');
            field.siblings('.field-validation-error').text(message).show();
        }
        
        function clearFieldError(fieldName) {
            const field = $(`input[name="${fieldName}"]`);
            field.removeClass('is-invalid');
            field.siblings('.field-validation-error').hide();
        }
    </script>
}